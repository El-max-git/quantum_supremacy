# ========================================
# Upload Directory Protection
# Block PHP execution but allow file access
# ========================================

Options -Indexes

# Block execution of PHP files
<FilesMatch "\.(php|php3|php4|php5|phtml|inc)$">
    <IfModule !mod_authz_core.c>
        Order deny,allow
        Deny from all
    </IfModule>
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
</FilesMatch>

# Allow only specific file types
<FilesMatch "\.(jpg|jpeg|png|gif|pdf|doc|docx|zip)$">
    <IfModule !mod_authz_core.c>
        Order allow,deny
        Allow from all
    </IfModule>
    <IfModule mod_authz_core.c>
        Require all granted
    </IfModule>
</FilesMatch>

